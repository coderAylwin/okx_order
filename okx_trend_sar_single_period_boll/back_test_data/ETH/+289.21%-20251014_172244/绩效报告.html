
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETH - SAR Single Period Trend Filter 策略绩效报告</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 30px;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #007bff;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #007bff;
            margin: 0;
            font-size: 2.5rem;
        }
        .header p {
            color: #666;
            margin: 10px 0 0 0;
            font-size: 1.1rem;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .metric-card.positive {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        .metric-card.negative {
            background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .chart-container {
            margin: 40px 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
        }
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .chart-title {
            text-align: center;
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        .section {
            margin: 40px 0;
        }
        .section h2 {
            color: #007bff;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .nav-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        .nav-table th, .nav-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .nav-table th {
            background-color: #007bff;
            color: white;
            font-weight: bold;
        }
        .nav-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .nav-table tr:hover {
            background-color: #f5f5f5;
        }
        .summary-box {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📈 ETH - SAR Single Period Trend Filter 策略绩效报告</h1>
            <p>生成时间: 2025-10-14 17:22:47</p>
            <p>回测期间: 2025-09-01 至 2025-10-13 (43 天)</p>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card positive">
                <div class="metric-label">💰 总收益率</div>
                <div class="metric-value">+17.36%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">📈 年化收益率</div>
                <div class="metric-value">+289.21%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">⚠️ 最大回撤</div>
                <div class="metric-value">-8.89%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">🎯 夏普比率</div>
                <div class="metric-value">8.54</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">📉 年化波动率</div>
                <div class="metric-value">33.51%</div>
            </div>
            <div class="metric-card positive">
                <div class="metric-label">🎯 胜率</div>
                <div class="metric-value">55.6%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">📊 盈亏比</div>
                <div class="metric-value">1.19</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">🔄 总交易次数</div>
                <div class="metric-value">225</div>
            </div>
        </div>
        
        <div class="summary-box">
            <h3>📊 资金概览</h3>
            <p><strong>初始资金:</strong> $100,000.00</p>
            <p><strong>最终净值:</strong> $117,362.30</p>
            <p><strong>净盈亏:</strong> $17,362.30</p>
        </div>
        
        <div class="summary-box">
            <h3>📈 交易统计</h3>
            <p><strong>总交易次数:</strong> 225 次</p>
            <p><strong>盈利交易:</strong> 125 次</p>
            <p><strong>亏损交易:</strong> 100 次</p>
            <p><strong>胜率:</strong> 55.6%</p>
            <p><strong>盈亏比:</strong> 1.19</p>
        </div>
        
        <div class="summary-box">
            <h3>⚙️ 策略配置</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4>📊 单周期SAR策略参数</h4>
                    <p><strong>时间周期:</strong> 15m</p>
                    <p><strong>指标周期:</strong> 14</p>
                </div>
                <div>
                    <h4>🎯 SAR参数</h4>
                    <p><strong>起始值:</strong> 0.005</p>
                    <p><strong>递增值:</strong> 0.005</p>
                    <p><strong>最大值:</strong> 0.04</p>
                </div>
            </div>
            <div style="margin-top: 15px;">
                <h4>💰 止盈止损配置</h4>
                <p><strong>固定止盈:</strong> 0.8%</p>
                <p><strong>最大亏损:</strong> 0%</p>
            </div>
        </div>
        
        <div class="chart-container">
            <h2>📈 绩效图表</h2>
            
            <div class="chart-title">💰 净值曲线</div>
            <div class="chart-wrapper">
                <canvas id="navChart"></canvas>
            </div>
            
            <div class="chart-title">📊 累计收益率</div>
            <div class="chart-wrapper">
                <canvas id="returnChart"></canvas>
            </div>
            
            <div class="chart-title">📉 回撤分析</div>
            <div class="chart-wrapper">
                <canvas id="drawdownChart"></canvas>
            </div>
        </div>
        
        <div class="section">
            <h2>📋 每日净值明细</h2>
            <table class="nav-table">
        <thead>
            <tr>
                <th>日期</th>
                <th>价格</th>
                <th>持仓</th>
                <th>持仓价值</th>
                <th>现金余额</th>
                <th>总净值</th>
                <th>日收益率</th>
                <th>累计收益率</th>
                <th>回撤</th>
            </tr>
        </thead>
        <tbody>
        
            <tr>
                <td>2025-09-14</td>
                <td>$4,584.07</td>
                <td>short</td>
                <td>$110,281.72</td>
                <td>$22.09</td>
                <td>$110,303.81</td>
                <td>-0.19%</td>
                <td>+10.30%</td>
                <td>-0.19%</td>
            </tr>
            
            <tr>
                <td>2025-09-15</td>
                <td>$4,498.90</td>
                <td>short</td>
                <td>$110,203.25</td>
                <td>$22.00</td>
                <td>$110,225.26</td>
                <td>-0.07%</td>
                <td>+10.23%</td>
                <td>-0.26%</td>
            </tr>
            
            <tr>
                <td>2025-09-16</td>
                <td>$4,465.00</td>
                <td>short</td>
                <td>$110,791.83</td>
                <td>$22.06</td>
                <td>$110,813.89</td>
                <td>+0.53%</td>
                <td>+10.81%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-09-17</td>
                <td>$4,487.50</td>
                <td>short</td>
                <td>$105,720.12</td>
                <td>$21.15</td>
                <td>$105,741.26</td>
                <td>-4.58%</td>
                <td>+5.74%</td>
                <td>-4.58%</td>
            </tr>
            
            <tr>
                <td>2025-09-18</td>
                <td>$4,597.09</td>
                <td>long</td>
                <td>$104,955.70</td>
                <td>$20.98</td>
                <td>$104,976.68</td>
                <td>-0.72%</td>
                <td>+4.98%</td>
                <td>-5.27%</td>
            </tr>
            
            <tr>
                <td>2025-09-19</td>
                <td>$4,472.72</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$105,528.82</td>
                <td>$105,528.82</td>
                <td>+0.53%</td>
                <td>+5.53%</td>
                <td>-4.77%</td>
            </tr>
            
            <tr>
                <td>2025-09-20</td>
                <td>$4,495.71</td>
                <td>long</td>
                <td>$106,561.81</td>
                <td>$21.20</td>
                <td>$106,583.01</td>
                <td>+1.00%</td>
                <td>+6.58%</td>
                <td>-3.82%</td>
            </tr>
            
            <tr>
                <td>2025-09-21</td>
                <td>$4,480.22</td>
                <td>long</td>
                <td>$107,432.09</td>
                <td>$21.48</td>
                <td>$107,453.57</td>
                <td>+0.82%</td>
                <td>+7.45%</td>
                <td>-3.03%</td>
            </tr>
            
            <tr>
                <td>2025-09-22</td>
                <td>$4,165.79</td>
                <td>long</td>
                <td>$110,740.03</td>
                <td>$22.31</td>
                <td>$110,762.34</td>
                <td>+3.08%</td>
                <td>+10.76%</td>
                <td>-0.05%</td>
            </tr>
            
            <tr>
                <td>2025-09-23</td>
                <td>$4,179.05</td>
                <td>long</td>
                <td>$107,524.03</td>
                <td>$21.63</td>
                <td>$107,545.66</td>
                <td>-2.90%</td>
                <td>+7.55%</td>
                <td>-2.95%</td>
            </tr>
            
            <tr>
                <td>2025-09-24</td>
                <td>$4,163.52</td>
                <td>long</td>
                <td>$107,088.65</td>
                <td>$21.57</td>
                <td>$107,110.21</td>
                <td>-0.40%</td>
                <td>+7.11%</td>
                <td>-3.34%</td>
            </tr>
            
            <tr>
                <td>2025-09-25</td>
                <td>$4,000.50</td>
                <td>short</td>
                <td>$109,126.04</td>
                <td>$21.65</td>
                <td>$109,147.69</td>
                <td>+1.90%</td>
                <td>+9.15%</td>
                <td>-1.50%</td>
            </tr>
            
            <tr>
                <td>2025-09-26</td>
                <td>$3,943.81</td>
                <td>long</td>
                <td>$110,300.48</td>
                <td>$22.04</td>
                <td>$110,322.51</td>
                <td>+1.08%</td>
                <td>+10.32%</td>
                <td>-0.44%</td>
            </tr>
            
            <tr>
                <td>2025-09-27</td>
                <td>$4,016.42</td>
                <td>long</td>
                <td>$113,962.70</td>
                <td>$22.83</td>
                <td>$113,985.54</td>
                <td>+3.32%</td>
                <td>+13.99%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-09-28</td>
                <td>$4,019.18</td>
                <td>long</td>
                <td>$113,813.53</td>
                <td>$22.77</td>
                <td>$113,836.30</td>
                <td>-0.13%</td>
                <td>+13.84%</td>
                <td>-0.13%</td>
            </tr>
            
            <tr>
                <td>2025-09-29</td>
                <td>$4,163.28</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$113,050.76</td>
                <td>$113,050.76</td>
                <td>-0.69%</td>
                <td>+13.05%</td>
                <td>-0.82%</td>
            </tr>
            
            <tr>
                <td>2025-09-30</td>
                <td>$4,117.88</td>
                <td>short</td>
                <td>$114,616.66</td>
                <td>$22.92</td>
                <td>$114,639.58</td>
                <td>+1.41%</td>
                <td>+14.64%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-10-01</td>
                <td>$4,324.55</td>
                <td>long</td>
                <td>$112,609.55</td>
                <td>$22.51</td>
                <td>$112,632.06</td>
                <td>-1.75%</td>
                <td>+12.63%</td>
                <td>-1.75%</td>
            </tr>
            
            <tr>
                <td>2025-10-02</td>
                <td>$4,435.38</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$113,609.74</td>
                <td>$113,609.74</td>
                <td>+0.87%</td>
                <td>+13.61%</td>
                <td>-0.90%</td>
            </tr>
            
            <tr>
                <td>2025-10-03</td>
                <td>$4,533.18</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$114,742.85</td>
                <td>$114,742.85</td>
                <td>+1.00%</td>
                <td>+14.74%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-10-04</td>
                <td>$4,453.67</td>
                <td>short</td>
                <td>$114,322.59</td>
                <td>$22.95</td>
                <td>$114,345.55</td>
                <td>-0.35%</td>
                <td>+14.35%</td>
                <td>-0.35%</td>
            </tr>
            
            <tr>
                <td>2025-10-05</td>
                <td>$4,531.01</td>
                <td>short</td>
                <td>$115,564.32</td>
                <td>$23.22</td>
                <td>$115,587.53</td>
                <td>+1.09%</td>
                <td>+15.59%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-10-06</td>
                <td>$4,671.15</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$121,217.19</td>
                <td>$121,217.19</td>
                <td>+4.87%</td>
                <td>+21.22%</td>
                <td>0.00%</td>
            </tr>
            
            <tr>
                <td>2025-10-07</td>
                <td>$4,510.48</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$120,279.53</td>
                <td>$120,279.53</td>
                <td>-0.77%</td>
                <td>+20.28%</td>
                <td>-0.77%</td>
            </tr>
            
            <tr>
                <td>2025-10-08</td>
                <td>$4,445.05</td>
                <td>short</td>
                <td>$115,741.10</td>
                <td>$23.22</td>
                <td>$115,764.32</td>
                <td>-3.75%</td>
                <td>+15.76%</td>
                <td>-4.50%</td>
            </tr>
            
            <tr>
                <td>2025-10-09</td>
                <td>$4,312.36</td>
                <td>short</td>
                <td>$111,863.05</td>
                <td>$22.39</td>
                <td>$111,885.44</td>
                <td>-3.35%</td>
                <td>+11.89%</td>
                <td>-7.70%</td>
            </tr>
            
            <tr>
                <td>2025-10-10</td>
                <td>$4,101.01</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$111,959.99</td>
                <td>$111,959.99</td>
                <td>+0.07%</td>
                <td>+11.96%</td>
                <td>-7.64%</td>
            </tr>
            
            <tr>
                <td>2025-10-11</td>
                <td>$3,822.61</td>
                <td>long</td>
                <td>$110,421.06</td>
                <td>$22.50</td>
                <td>$110,443.56</td>
                <td>-1.35%</td>
                <td>+10.44%</td>
                <td>-8.89%</td>
            </tr>
            
            <tr>
                <td>2025-10-12</td>
                <td>$4,031.83</td>
                <td>空仓</td>
                <td>$0.00</td>
                <td>$113,397.07</td>
                <td>$113,397.07</td>
                <td>+2.67%</td>
                <td>+13.40%</td>
                <td>-6.45%</td>
            </tr>
            
            <tr>
                <td>2025-10-13</td>
                <td>$4,147.25</td>
                <td>short</td>
                <td>$117,338.97</td>
                <td>$23.33</td>
                <td>$117,362.30</td>
                <td>+3.50%</td>
                <td>+17.36%</td>
                <td>-3.18%</td>
            </tr>
            </tbody></table><p style="text-align: center; color: #666; margin-top: 10px;">* 仅显示最近30天数据，完整数据共43天</p>
        </div>
        
        <div class="footer">
            <p>🤖 由 SAR Single Period Trend Filter 策略自动生成</p>
        </div>
    </div>

    <script>
        // 图表数据
        const chartData = {"dates": ["2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-06", "2025-09-07", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-13", "2025-09-14", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-20", "2025-09-21", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-27", "2025-09-28", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-04", "2025-10-05", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-11", "2025-10-12", "2025-10-13"], "nav_values": [101797.38, 103609.74, 104080.55, 104965.56, 105855.26, 104237.04, 104714.77, 105730.14, 103622.42, 104710.01, 106478.9, 104327.59, 110515.11, 110303.81, 110225.26, 110813.89, 105741.26, 104976.68, 105528.82, 106583.01, 107453.57, 110762.34, 107545.66, 107110.21, 109147.69, 110322.51, 113985.54, 113836.3, 113050.76, 114639.58, 112632.06, 113609.74, 114742.85, 114345.55, 115587.53, 121217.19, 120279.53, 115764.32, 111885.44, 111959.99, 110443.56, 113397.07, 117362.3], "cumulative_returns": [1.8, 3.61, 4.08, 4.97, 5.86, 4.24, 4.71, 5.73, 3.62, 4.71, 6.48, 4.33, 10.52, 10.3, 10.23, 10.81, 5.74, 4.98, 5.53, 6.58, 7.45, 10.76, 7.55, 7.11, 9.15, 10.32, 13.99, 13.84, 13.05, 14.64, 12.63, 13.61, 14.74, 14.35, 15.59, 21.22, 20.28, 15.76, 11.89, 11.96, 10.44, 13.4, 17.36], "drawdowns": [0.0, 0.0, 0.0, 0.0, 0.0, -1.53, -1.08, -0.12, -2.11, -1.08, 0.0, -2.02, 0.0, -0.19, -0.26, 0.0, -4.58, -5.27, -4.77, -3.82, -3.03, -0.05, -2.95, -3.34, -1.5, -0.44, 0.0, -0.13, -0.82, 0.0, -1.75, -0.9, 0.0, -0.35, 0.0, 0.0, -0.77, -4.5, -7.7, -7.64, -8.89, -6.45, -3.18], "initial_capital": 100000, "max_drawdown_point": {"date": "2025-10-11", "value": -8.89}};
        
        // 通用图表配置
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                intersect: false,
                mode: 'index'
            },
            plugins: {
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleColor: 'white',
                    bodyColor: 'white',
                    borderColor: '#007bff',
                    borderWidth: 1,
                    cornerRadius: 5,
                    displayColors: false,
                    callbacks: {
                        title: function(context) {
                            return '日期: ' + context[0].label;
                        }
                    }
                },
                legend: {
                    display: true,
                    position: 'top'
                }
            },
            scales: {
                x: {
                    type: 'category',
                    display: true,
                    title: {
                        display: true,
                        text: '日期'
                    },
                    grid: {
                        display: true,
                        color: 'rgba(0,0,0,0.1)'
                    }
                },
                y: {
                    display: true,
                    grid: {
                        display: true,
                        color: 'rgba(0,0,0,0.1)'
                    }
                }
            }
        };

        // 1. 净值曲线图
        const navCtx = document.getElementById('navChart').getContext('2d');
        new Chart(navCtx, {
            type: 'line',
            data: {
                labels: chartData.dates,
                datasets: [
                    {
                        label: '净值曲线',
                        data: chartData.nav_values,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1,
                        pointRadius: 1,
                        pointHoverRadius: 5
                    },
                    {
                        label: '初始资金线',
                        data: Array(chartData.dates.length).fill(chartData.initial_capital),
                        borderColor: '#6c757d',
                        backgroundColor: 'transparent',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    ...commonOptions.scales,
                    y: {
                        ...commonOptions.scales.y,
                        title: {
                            display: true,
                            text: '净值 ($)'
                        },
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toLocaleString();
                            }
                        }
                    }
                },
                plugins: {
                    ...commonOptions.plugins,
                    tooltip: {
                        ...commonOptions.plugins.tooltip,
                        callbacks: {
                            ...commonOptions.plugins.tooltip.callbacks,
                            label: function(context) {
                                if (context.datasetIndex === 0) {
                                    return '净值: $' + context.parsed.y.toLocaleString();
                                } else {
                                    return '初始资金: $' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    }
                }
            }
        });

        // 2. 累计收益率图
        const returnCtx = document.getElementById('returnChart').getContext('2d');
        new Chart(returnCtx, {
            type: 'line',
            data: {
                labels: chartData.dates,
                datasets: [
                    {
                        label: '累计收益率',
                        data: chartData.cumulative_returns,
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1,
                        pointRadius: 1,
                        pointHoverRadius: 5
                    },
                    {
                        label: '零基准线',
                        data: Array(chartData.dates.length).fill(0),
                        borderColor: '#6c757d',
                        backgroundColor: 'transparent',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    ...commonOptions.scales,
                    y: {
                        ...commonOptions.scales.y,
                        title: {
                            display: true,
                            text: '收益率 (%)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(1) + '%';
                            }
                        }
                    }
                },
                plugins: {
                    ...commonOptions.plugins,
                    tooltip: {
                        ...commonOptions.plugins.tooltip,
                        callbacks: {
                            ...commonOptions.plugins.tooltip.callbacks,
                            label: function(context) {
                                if (context.datasetIndex === 0) {
                                    return '累计收益率: ' + context.parsed.y.toFixed(2) + '%';
                                } else {
                                    return '零基准线: 0%';
                                }
                            }
                        }
                    }
                }
            }
        });

        // 3. 回撤分析图
        const drawdownCtx = document.getElementById('drawdownChart').getContext('2d');
        const drawdownChart = new Chart(drawdownCtx, {
            type: 'line',
            data: {
                labels: chartData.dates,
                datasets: [
                    {
                        label: '回撤曲线',
                        data: chartData.drawdowns,
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.2)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1,
                        pointRadius: 1,
                        pointHoverRadius: 5
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    ...commonOptions.scales,
                    y: {
                        ...commonOptions.scales.y,
                        title: {
                            display: true,
                            text: '回撤 (%)'
                        },
                        max: 0,
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(1) + '%';
                            }
                        }
                    }
                },
                plugins: {
                    ...commonOptions.plugins,
                    tooltip: {
                        ...commonOptions.plugins.tooltip,
                        callbacks: {
                            ...commonOptions.plugins.tooltip.callbacks,
                            label: function(context) {
                                return '回撤: ' + context.parsed.y.toFixed(2) + '%';
                            }
                        }
                    }
                }
            }
        });

        // 标记最大回撤点
        if (chartData.max_drawdown_point) {
            const maxDDIndex = chartData.dates.indexOf(chartData.max_drawdown_point.date);
            if (maxDDIndex !== -1) {
                // 添加最大回撤点标记
                drawdownChart.data.datasets.push({
                    label: '最大回撤点',
                    data: chartData.dates.map((date, index) => 
                        index === maxDDIndex ? chartData.max_drawdown_point.value : null
                    ),
                    borderColor: '#ff6b6b',
                    backgroundColor: '#ff6b6b',
                    borderWidth: 3,
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    showLine: false,
                    fill: false
                });
                drawdownChart.update();
            }
        }
    </script>
</body>
</html>
        